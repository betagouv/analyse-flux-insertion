_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{"17LQ":function(t,e,n){var i=n("o0o1"),r=n("lSNA"),a=n("RIqP"),c=n("yXPU");function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={Test:"Instruction","Test - CNAF - Instruction":"Instruction","Test - CNAF - B\xe9n\xe9ficiaire":"B\xe9n\xe9ficiaire","Test - Pole Emploi":"P\xf4le Emploi"},l="https://stats.data.gouv.fr";function p(){return(p=c(i.mark((function t(e,n){var r,c,o,p,h,d;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c="".concat(l,"/index.php?date=today&expanded=1&filter_limit=25&format=JSON&idSite=").concat("158","&method=Events.getCategory&module=API&period=month&segment=&token_auth=").concat(e),t.next=3,fetch(c);case 3:return o=t.sent,t.next=6,o.json();case 6:return p=t.sent,h=(r=[]).concat.apply(r,a(p.filter((function(t){return u[t.label]==n})).map((function(t){return t.subtable})))),(d=h.map((function(t){return JSON.parse(t.label)})).map((function(t){var e=t.timestamp||t.timetamp;return s({seed:Math.random(),timestamp:e,duration:t.duration,email:{total:t.withEmail,withAutorisation:t.withAutorisation,withExplicitRefusal:t.withExplicitRefusal,withoutAutorisationDetails:t.withoutAutorisationDetails},cDate:new Date(e),phone:{}},t)}))).sort((function(t,e){return t.cDate-e.cDate})),t.abrupt("return",d);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.fetchLog=function(t,e){return p.apply(this,arguments)}},"2zrp":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n("nKUr"),r=n("q1tI"),a=n("17LQ");function c(t){t.children;var e=t.onRunRefresh,n=t.category,c=Object(r.useState)(!1),o=c[0],s=c[1],u=Object(r.useState)(window.localStorage.getItem("token")||""),l=u[0],p=u[1];Object(r.useEffect)((function(){o&&l&&n&&e&&a.fetchLog&&Object(a.fetchLog)(l,n).then((function(t){e(t)}))}),[o,l]);var h=Object(r.useCallback)((function(t){s(t.target.checked),t.target.checked||e([])})),d=Object(r.useCallback)((function(t){p(t.target.value),window.localStorage.setItem("token",t.target.value)})),f=Object(r.useCallback)((function(t){p(""),s(!1),window.localStorage.removeItem("token"),e&&e([])}));return Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse"},children:[Object(i.jsxs)("label",{children:[Object(i.jsx)("input",{onChange:h,type:"checkbox",checked:o}),"Admin"]}),o&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("a",{target:"_blank",rel:"noopener",href:"https://stats.data.gouv.fr/index.php?module=UsersManager&action=userSettings",children:"R\xe9cup\xe9rer mon API Authentication Token"}),Object(i.jsx)("input",{onChange:d,type:"password",value:l}),Object(i.jsx)("button",{onClick:f,children:"Supprimer le token"})]})]})}},"3Ztg":function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/lecteur/cnaf/instruction",function(){return n("VtO9")}])},GYdj:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var i={M:"Mensuel",I:"Quotidien",R:"Reprise"},r={D:"B\xe9n\xe9ficiaires",I:"Instructions",R:"Nouveau recueil"},a={DEM:"Demandeur",CJT:"Conjoint",ENF:"Enfant",AUT:"Autre"}},Ji7U:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("s4An");function r(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(i.a)(t,e)}},Svyj:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i="data:text/csv;charset=utf-8,"+n.join(";")+"\n"+e.map((function(t){return t.join(";")})).join("\n"),r=encodeURI(i),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download",t),document.body.appendChild(a),a.click()}},VtO9:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return w}));var i=n("nKUr"),r=n("o0o1"),a=n.n(r),c=n("HaE+"),o=n("q1tI"),s=(n("g4pe"),n("2zrp")),u=n("CafY"),l=n("RPyZ"),p=n("aIN1"),h=n("vRNQ"),d=n.n(h),f=n("GYdj"),j=n("PQ1l"),b=n("e6fs"),m=n("Svyj"),O=n("jwbB"),x=Object(j.b)("Test - CNAF - Instruction"),g=!1;function w(){var t=Object(o.useReducer)(x,[],j.a),e=t[0],n=t[1],r=Object(o.useState)(0),h=r[0],w=r[1],y=Object(o.useCallback)((function(t){n({type:"reset",items:t})})),N=function(){var t=Object(c.a)(a.a.mark((function t(e){var i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return w(e.size),i=new Date,t.next=4,new Promise((function(t){var r=new FileReader;r.onload=function(r){var a=new b.a(r.target.result);n({type:"append",item:{seed:Math.random(),timestamp:(new Date).toISOString().slice(0,19),duration:new Date-i,filename:e.name,fileSize:e.size,fileDatetime:a.fileDatetime,frequency:a.frequency,origin:a.origin,parseError:a.parseError,applicationsCount:a.applicationsCount,applicantsCount:a.applicantsCount,email:{total:a.applicationsWithEmail.length,withAutorisation:a.applicationsWithUsableEmail.length,withExplicitRefusal:a.applicationsWithForbiddenEmailUsage.length,withoutAutorisationDetails:a.applicationsWithoutEmailUsage.length},phone:{total:a.applicatonsWithPhone.length,withAutorisation:a.applicationsWithUsablePhone.length,withExplicitRefusal:a.applicationsWithForbiddenPhoneUsage.length,withoutAutorisationDetails:a.applicationsWithoutPhoneUsage.length},withDSP:a.applicationsWithDSP.length,applicantsPersonalData:a.applicantsPersonalData}}),t()},r.readAsText(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(t){return Math.round(t)};return Object(i.jsxs)(u.a,{className:d.a.container,handleFile:N,children:[Object(i.jsx)(s.a,{category:"Instruction",onRunRefresh:y}),Object(i.jsxs)("main",{className:d.a.main,children:[Object(i.jsxs)("h1",{className:d.a.title,children:["Lecteur de fichier",Object(i.jsx)("br",{}),"\xab Instruction \xbb de la CNAF"]}),Object(i.jsx)(l.a,{handleFile:N,fileSize:h}),e&&e.length>0&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{className:d.a.subtitle,children:"Historique"}),Object(i.jsxs)("table",{children:[Object(i.jsxs)("thead",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{rowSpan:"2",children:"Date"}),Object(i.jsx)("th",{rowSpan:"2",children:"Fichier"}),g,g,Object(i.jsx)("th",{rowSpan:"2",children:"Date du fichier"}),Object(i.jsx)("th",{rowSpan:"2",children:"Fr\xe9quence"}),Object(i.jsx)("th",{rowSpan:"2",children:"Nature"}),Object(i.jsx)("th",{rowSpan:"2",children:"Dossiers"}),Object(i.jsx)("th",{colSpan:"8",children:"avec email"}),Object(i.jsx)("th",{colSpan:"8",children:"avec t\xe9l\xe9phone"}),Object(i.jsx)("th",{colSpan:"2",rowSpan:"2",children:"avec DSP (%)"}),Object(i.jsx)("th",{rowSpan:"2",children:"Erreur"})]}),Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{colSpan:"2",children:"# (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"et autorisation (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"refus explicit (%)"}),Object(i.jsx)("th",{colSpan:"2",children:Object(i.jsx)("abbr",{title:"Balise AUTORUTIADRELEC pr\xe9sente et \xe9gale \xe0 'I'",children:"inconnu explicit (I) (%)"})}),Object(i.jsx)("th",{colSpan:"2",children:"# (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"et autorisation (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"refus explicit (%)"}),Object(i.jsx)("th",{colSpan:"2",children:Object(i.jsx)("abbr",{title:"Balise AUTORUTITEL pr\xe9sente et \xe9gale \xe0 'I'",children:"inconnu explicit (I) (%)"})})]})]}),Object(i.jsx)("tbody",{children:e.map((function(t){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:t.timestamp}),Object(i.jsx)("td",{children:t.filename}),g,g,Object(i.jsx)("td",{children:t.fileDatetime}),Object(i.jsx)("td",{children:"".concat(t.frequency," (").concat(f.b[t.frequency]||"?",")")}),Object(i.jsx)("td",{children:"".concat(t.origin," (").concat(f.c[t.origin]||"?",")")}),Object(i.jsx)("td",{className:d.a.numeric,children:t.applicationsCount}),Object(i.jsx)("td",{className:d.a.numeric,children:t.email.total}),Object(i.jsx)("td",{className:"shrink",children:v(t.email.total/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.email.withAutorisation}),Object(i.jsx)("td",{className:"shrink",children:v(t.email.withAutorisation/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.email.withExplicitRefusal}),Object(i.jsx)("td",{className:"shrink",children:v(t.email.withExplicitRefusal/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.email.withoutAutorisationDetails}),Object(i.jsx)("td",{className:"shrink",children:v(t.email.withoutAutorisationDetails/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.phone.total}),Object(i.jsx)("td",{className:"shrink",children:v(t.phone.total/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.phone.withAutorisation}),Object(i.jsx)("td",{className:"shrink",children:v(t.phone.withAutorisation/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.phone.withExplicitRefusal}),Object(i.jsx)("td",{className:"shrink",children:v(t.phone.withExplicitRefusal/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.phone.withoutAutorisationDetails}),Object(i.jsx)("td",{className:"shrink",children:v(t.phone.withoutAutorisationDetails/t.applicationsCount*100)}),Object(i.jsx)("td",{className:d.a.numeric,children:t.withDSP}),Object(i.jsx)("td",{className:"shrink",children:v(t.withDSP/t.applicationsCount*100)}),Object(i.jsx)("td",{children:t.parseError?"Oui":"Non"})]},"".concat(t.timestamp,"-").concat(t.filename,"-").concat(t.seed))}))})]}),Object(i.jsx)("button",{className:d.a.button,onClick:function(){return n({type:"reset"})},children:"Vider l'historique"}),Object(i.jsx)("button",{className:d.a.button,onClick:function(){var t=[];e.forEach((function(e){e.applicantsPersonalData.forEach((function(n){t.push([n.rsaApplicationNumber||"",n.socialSecurityNumber||"",n.lastName||"",n.firstName||"",f.a[n.role]||"",n.emailAddress||"",n.phoneNumber||"",e.filename])}))}));var n="flux_insertion_donnees_personnelles_"+Object(O.b)()+".csv";Object(m.a)(n,t,["NUMERO DEMANDE RSA","NIR","NOM","PRENOM","ROLE","EMAIL","TELEPHONE","FICHIER SOURCE"])},children:"Exporter les donn\xe9es de contacts"})]}),Object(i.jsx)(p.a,{subject:"Flux instruction CNAF",pourquoi:"Pourquoi un lecteur de fichier CNAF\xa0?",text:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("p",{className:d.a.text,children:"Tous les d\xe9partements n'ont pas les outils pour analyser les fichiers envoy\xe9s par la CNAF. Cela peut ralentir et compliquer nos \xe9changes."}),Object(i.jsx)("p",{className:d.a.text,children:"Avec cet outil, nous souhaitons permettre aux personnes qui ont acc\xe8s \xe0 ces fichiers d'en extraire des statistiques g\xe9n\xe9rales sans avoir \xe0 mettre les mains dans le camboui elles-m\xeame."}),Object(i.jsx)("p",{className:d.a.text,children:"Aujourd'hui, nous cherchons \xe0 comprendre pourquoi pour la CNAF 90% des dossiers pr\xe9sents dans les fichiers quotidiens d'instructions contiennent des emails alors que ce taux est de 30% \xe0 50% pour certains d\xe9partements."})]})})]})]})}},aIN1:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("nKUr"),r=n("oRLf"),a=n("vRNQ"),c=n.n(a);function o(t){var e=t.pourquoi,n=t.text,a=t.subject;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{id:"pourquoi",className:c.a.subtitle,children:e}),n,Object(i.jsxs)("p",{className:c.a.description,children:["Un probl\xe8me, une question ? Contactez-nous \xe0"," ",Object(i.jsx)(r.a,{subject:a,children:"data.insertion@beta.gouv.fr"})]})]})}},e6fs:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("KQm4"),r=n("1OyB"),a=n("vuIU"),c=n("Ji7U"),o=n("md7G"),s=n("foSv"),u=n("DCjv"),l=n("oIwm");n("z4L3");function p(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Object(s.a)(t);if(e){var r=Object(s.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var h=function(t){Object(c.a)(n,t);var e=p(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(a.a)(n,[{key:"applications",get:function(){return Object(i.a)(this.dom.getElementsByTagName("InfoDemandeRSA")).map((function(t){return new l.a(t)}))}},{key:"applicationsWithEmail",get:function(){return this.applications.filter((function(t){return t.emailAddress}))}},{key:"applicationsWithUsableEmail",get:function(){return this.applications.filter((function(t){return t.withUsableEmail()}))}},{key:"applicationsWithForbiddenEmailUsage",get:function(){return this.applications.filter((function(t){return t.withForbiddenEmailUsage()}))}},{key:"applicationsWithoutEmailUsage",get:function(){return this.applications.filter((function(t){return t.withoutEmailUsage()}))}},{key:"applicatonsWithPhone",get:function(){return this.applications.filter((function(t){return t.phoneNumber}))}},{key:"applicationsWithUsablePhone",get:function(){return this.applications.filter((function(t){return t.withUsablePhone()}))}},{key:"applicationsWithForbiddenPhoneUsage",get:function(){return this.applications.filter((function(t){return t.withForbiddenPhoneUsage()}))}},{key:"applicationsWithoutPhoneUsage",get:function(){return this.applications.filter((function(t){return t.withoutPhoneUsage()}))}},{key:"applicationsWithDSP",get:function(){return this.applications.filter((function(t){return t.withDSP()}))}},{key:"applicantsPersonalData",get:function(){return this.applicants.map((function(t){return t.personalData}))}}]),n}(u.a)},foSv:function(t,e,n){"use strict";function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return i}))},md7G:function(t,e,n){"use strict";function i(t){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return!e||"object"!==i(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}n.d(e,"a",(function(){return r}))},s4An:function(t,e,n){"use strict";function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return i}))}},[["3Ztg",0,2,1,3,4]]]);