_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{"3Ztg":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/lecteur/cnaf/instruction",function(){return n("VtO9")}])},VtO9:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var a=n("nKUr"),r=n("KQm4"),i=n("rePB"),c=n("q1tI"),s=(n("g4pe"),n("2zrp")),l=n("CafY"),o=n("RPyZ"),u=n("aIN1"),h=n("vRNQ"),d=n.n(h),m=n("MZOi"),j=n("mPdc"),b=n("RHh3"),O={DEM:"Demandeur",CJT:"Conjoint",ENF:"Enfant",AUT:"Autre"},p=function(e){var t=[];return e.forEach((function(e){var n,a,i,c,s=null===(n=e.getElementsByTagName("NUMDEMRSA")[0])||void 0===n?void 0:n.innerHTML,l=null===(a=e.getElementsByTagName("ADRELEC")[0])||void 0===a?void 0:a.innerHTML,o=null===(i=e.getElementsByTagName("NUMTEL")[0])||void 0===i?void 0:i.innerHTML,u=null===(c=e.getElementsByTagName("NIR")[0])||void 0===c?void 0:c.innerHTML;Object(b.a)(Array,Object(r.a)(e.getElementsByTagName("Personne"))).forEach((function(e){var n,a,r,i=null===(n=e.getElementsByTagName("NOM")[0])||void 0===n?void 0:n.innerHTML,c=null===(a=e.getElementsByTagName("PRENOM")[0])||void 0===a?void 0:a.innerHTML,h=O[null===(r=e.getElementsByTagName("ROLEPERS")[0])||void 0===r?void 0:r.innerHTML];t.push({rsaApplicationNumber:s,socialSecurityNumber:u,lastName:i,firstName:c,role:h,mailAddress:l,phoneNumber:o})}))})),t},g=n("jwbB");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=Object(j.b)("Test - CNAF - Instruction"),x=!1;function T(){var e=Object(c.useReducer)(N,[],j.a),t=e[0],n=e[1],i=Object(c.useState)(!1),h=i[0],O=i[1],f=Object(c.useState)(0),T=f[0],y=f[1],v=Object(c.useCallback)((function(e){n({type:"reset",items:e})})),w=function(e){y(e.size),O(!0);var t=new Date,a=new FileReader;a.onload=function(a){var i=function(e){var t=(new DOMParser).parseFromString(e,"application/xml"),n=t.getElementsByTagName("IdentificationFlux")[0],a=n.getElementsByTagName("TYPEFLUX")[0].innerHTML,i=n.getElementsByTagName("NATFLUX")[0].innerHTML,c=n.getElementsByTagName("DTCREAFLUX")[0].innerHTML,s=n.getElementsByTagName("HEUCREAFLUX")[0].innerHTML,l=Object(b.a)(Array,Object(r.a)(t.getElementsByTagName("InfoDemandeRSA"))),o=l.filter((function(e){return e.getElementsByTagName("ADRELEC").length})),u=l.filter((function(e){var t=e.getElementsByTagName("AUTORUTIADRELEC")[0];return e.getElementsByTagName("ADRELEC").length&&t&&"A"==t.innerHTML})),h=l.filter((function(e){var t=e.getElementsByTagName("AUTORUTIADRELEC")[0];return e.getElementsByTagName("ADRELEC").length&&t&&"R"==t.innerHTML})),d=l.filter((function(e){var t=e.getElementsByTagName("AUTORUTIADRELEC")[0];return e.getElementsByTagName("ADRELEC").length&&t&&"I"==t.innerHTML})),m=l.filter((function(e){return e.getElementsByTagName("NUMTEL").length})),j=(l.filter((function(e){var t=e.getElementsByTagName("AUTORUTITEL")[0];return e.getElementsByTagName("NUMTEL").length&&t&&"A"==t.innerHTML})),l.filter((function(e){var t=e.getElementsByTagName("AUTORUTITEL")[0];return e.getElementsByTagName("NUMTEL").length&&t&&"R"==t.innerHTML})),l.filter((function(e){var t=e.getElementsByTagName("AUTORUTITEL")[0];return e.getElementsByTagName("NUMTEL").length&&t&&"I"==t.innerHTML})),l.filter((function(e){return e.getElementsByTagName("DonneesSocioProfessionnelles").length})));return{fileDatetime:"".concat(c,"-").concat(s),frequency:a,type:i,error:t.activeElement&&"parsererror"==t.activeElement.nodeName,total:l.length,email:{total:o.length,withAutorisation:u.length,withExplicitRefusal:h.length,withoutAutorisationDetails:d.length},phone:{total:m.length,withAutorisation:u.length,withExplicitRefusal:h.length,withoutAutorisationDetails:d.length},withDSP:j.length,applicantsPersonalData:p(l)}}(a.target.result);O(!1),n({type:"append",item:E({seed:Math.random(),timestamp:(new Date).toISOString().slice(0,19),duration:new Date-t,filename:e.name,fileSize:e.size},i)})},a.readAsText(e)},A=function(e){return Math.round(e)};return Object(a.jsxs)(l.a,{className:d.a.container,handleFile:w,children:[Object(a.jsx)(s.a,{category:"Instruction",onRunRefresh:v}),Object(a.jsxs)("main",{className:d.a.main,children:[Object(a.jsxs)("h1",{className:d.a.title,children:["Lecteur de fichier",Object(a.jsx)("br",{}),"\xab Instruction \xbb de la CNAF"]}),Object(a.jsx)(o.a,{handleFile:w,isPending:h,fileSize:T,message:"Calcul des statistiques en cours, merci de patienter"}),t&&t.length>0&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{className:d.a.subtitle,children:"Historique"}),Object(a.jsxs)("table",{children:[Object(a.jsxs)("thead",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{rowSpan:"2",children:"Date"}),Object(a.jsx)("th",{rowSpan:"2",children:"Fichier"}),x,x,Object(a.jsx)("th",{rowSpan:"2",children:"Date du fichier"}),Object(a.jsx)("th",{rowSpan:"2",children:"Fr\xe9quence"}),Object(a.jsx)("th",{rowSpan:"2",children:"Nature"}),Object(a.jsx)("th",{rowSpan:"2",children:"Dossiers"}),Object(a.jsx)("th",{colSpan:"8",children:"avec email"}),Object(a.jsx)("th",{colSpan:"8",children:"avec t\xe9l\xe9phone"}),Object(a.jsx)("th",{colSpan:"2",rowSpan:"2",children:"DSP (%)"}),Object(a.jsx)("th",{rowSpan:"2",children:"Erreur"})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{colSpan:"2",children:"# (%)"}),Object(a.jsx)("th",{colSpan:"2",children:"et autorisation (%)"}),Object(a.jsx)("th",{colSpan:"2",children:"refus explicit (%)"}),Object(a.jsx)("th",{colSpan:"2",children:Object(a.jsx)("abbr",{title:"Balise AUTORUTIADRELEC pr\xe9sente et \xe9gale \xe0 'I'",children:"inconnu explicit (I) (%)"})}),Object(a.jsx)("th",{colSpan:"2",children:"# (%)"}),Object(a.jsx)("th",{colSpan:"2",children:"et autorisation (%)"}),Object(a.jsx)("th",{colSpan:"2",children:"refus explicit (%)"}),Object(a.jsx)("th",{colSpan:"2",children:Object(a.jsx)("abbr",{title:"Balise AUTORUTITEL pr\xe9sente et \xe9gale \xe0 'I'",children:"inconnu explicit (I) (%)"})})]})]}),Object(a.jsx)("tbody",{children:t.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:e.timestamp}),Object(a.jsx)("td",{children:e.filename}),x,x,Object(a.jsx)("td",{children:e.fileDatetime}),Object(a.jsx)("td",{children:"".concat(e.frequency," (").concat(m.a[e.frequency]||"?",")")}),Object(a.jsx)("td",{children:"".concat(e.type," (").concat(m.b[e.type]||"?",")")}),Object(a.jsx)("td",{className:d.a.numeric,children:e.total}),Object(a.jsx)("td",{className:d.a.numeric,children:e.email.total}),Object(a.jsx)("td",{className:"shrink",children:A(e.email.total/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.email.withAutorisation}),Object(a.jsx)("td",{className:"shrink",children:A(e.email.withAutorisation/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.email.withExplicitRefusal}),Object(a.jsx)("td",{className:"shrink",children:A(e.email.withExplicitRefusal/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.email.withoutAutorisationDetails}),Object(a.jsx)("td",{className:"shrink",children:A(e.email.withoutAutorisationDetails/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.phone.total}),Object(a.jsx)("td",{className:"shrink",children:A(e.phone.total/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.phone.withAutorisation}),Object(a.jsx)("td",{className:"shrink",children:A(e.phone.withAutorisation/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.phone.withExplicitRefusal}),Object(a.jsx)("td",{className:"shrink",children:A(e.phone.withExplicitRefusal/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.phone.withoutAutorisationDetails}),Object(a.jsx)("td",{className:"shrink",children:A(e.phone.withoutAutorisationDetails/e.total*100)}),Object(a.jsx)("td",{className:d.a.numeric,children:e.withDSP}),Object(a.jsx)("td",{className:"shrink",children:A(e.withDSP/e.total*100)}),Object(a.jsx)("td",{children:e.error?"Oui":"Non"})]},"".concat(e.timestamp,"-").concat(e.filename,"-").concat(e.seed))}))})]}),Object(a.jsx)("button",{className:d.a.button,onClick:function(){return n({type:"reset"})},children:"Vider l'historique"}),Object(a.jsx)("button",{className:d.a.button,onClick:function(){var e=[];t.forEach((function(t){t.applicantsPersonalData.forEach((function(n){e.push([].concat(Object(r.a)(Object.values(n)),[t.filename]))}))}));!function(e,t){var n="data:text/csv;charset=utf-8,"+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).join(",")+"\n"+t.map((function(e){return e.join(",")})).join("\n"),a=encodeURI(n),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("download",e),document.body.appendChild(r),r.click()}("flux_insertion_donnees_personnelles_"+Object(g.a)()+".csv",e,["NUMERO DEMANDE RSA","NIR","NOM","PRENOM","ROLE","EMAIL","TELEPHONE","FICHIER SOURCE"])},children:"Exporter les donn\xe9es de contacts"})]}),Object(a.jsx)(u.a,{subject:"Flux instruction CNAF",pourquoi:"Pourquoi un lecteur de fichier CNAF\xa0?",text:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("p",{className:d.a.text,children:"Tous les d\xe9partements n'ont pas les outils pour analyser les fichiers envoy\xe9s par la CNAF. Cela peut ralentir et compliquer nos \xe9changes."}),Object(a.jsx)("p",{className:d.a.text,children:"Avec cet outil, nous souhaitons permettre aux personnes qui ont acc\xe8s \xe0 ces fichiers d'en extraire des statistiques g\xe9n\xe9rales sans avoir \xe0 mettre les mains dans le camboui elles-m\xeame."}),Object(a.jsx)("p",{className:d.a.text,children:"Aujourd'hui, nous cherchons \xe0 comprendre pourquoi pour la CNAF 90% des dossiers pr\xe9sents dans les fichiers quotidiens d'instructions contiennent des emails alors que ce taux est de 30% \xe0 50% pour certains d\xe9partements."})]})})]})]})}},jwbB:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c}));var a=n("BsWD");function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,r=!1,i=void 0;try{for(var c,s=e[Symbol.iterator]();!(a=(c=s.next()).done)&&(n.push(c.value),!t||n.length!==t);a=!0);}catch(l){r=!0,i=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return n}}(e,t)||Object(a.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var i=function(e){var t=r(e.split("/"),3),n=t[0],a=t[1],i=t[2];return new Date(i,a-1,n)};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),n=e.getMonth()+1,a=e.getDate(),r=e.getHours(),i=e.getMinutes(),c=e.getSeconds();return t+"_"+n+"_"+a+"_"+r+"_"+i+"_"+c}function s(e){var t=e.getFullYear(),n=e.getMonth()+1;return e.getDate()+"/"+n+"/"+t}}},[["3Ztg",0,2,1,3,4]]]);