_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[19],{"17LQ":function(e,t,n){var i=n("o0o1"),a=n("lSNA"),c=n("RIqP"),r=n("yXPU");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={Test:"Instruction","Test - CNAF - Instruction":"Instruction","Test - CNAF - B\xe9n\xe9ficiaire":"B\xe9n\xe9ficiaire","Test - Pole Emploi":"P\xf4le Emploi"},u="https://stats.data.gouv.fr";function h(){return(h=r(i.mark((function e(t,n){var a,r,s,h,j,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(u,"/index.php?date=today&expanded=1&filter_limit=25&format=JSON&idSite=").concat("158","&method=Events.getCategory&module=API&period=month&segment=&token_auth=").concat(t),e.next=3,fetch(r);case 3:return s=e.sent,e.next=6,s.json();case 6:return h=e.sent,j=(a=[]).concat.apply(a,c(h.filter((function(e){return l[e.label]==n})).map((function(e){return e.subtable})))),(d=j.map((function(e){return JSON.parse(e.label)})).map((function(e){var t=e.timestamp||e.timetamp;return o({seed:Math.random(),timestamp:t,duration:e.duration,email:{total:e.withEmail,withAutorisation:e.withAutorisation,withExplicitRefusal:e.withExplicitRefusal,withoutAutorisationDetails:e.withoutAutorisationDetails},cDate:new Date(t),phone:{}},e)}))).sort((function(e,t){return e.cDate-t.cDate})),e.abrupt("return",d);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.fetchLog=function(e,t){return h.apply(this,arguments)}},"2zrp":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("nKUr"),a=n("q1tI"),c=n("17LQ");function r(e){e.children;var t=e.onRunRefresh,n=e.category,r=Object(a.useState)(!1),s=r[0],o=r[1],l=Object(a.useState)(window.localStorage.getItem("token")||""),u=l[0],h=l[1];Object(a.useEffect)((function(){s&&u&&n&&t&&c.fetchLog&&Object(c.fetchLog)(u,n).then((function(e){t(e)}))}),[s,u]);var j=Object(a.useCallback)((function(e){o(e.target.checked),e.target.checked||t([])})),d=Object(a.useCallback)((function(e){h(e.target.value),window.localStorage.setItem("token",e.target.value)})),p=Object(a.useCallback)((function(e){h(""),o(!1),window.localStorage.removeItem("token"),t&&t([])}));return Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse"},children:[Object(i.jsxs)("label",{children:[Object(i.jsx)("input",{onChange:j,type:"checkbox",checked:s}),"Admin"]}),s&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("a",{target:"_blank",rel:"noopener",href:"https://stats.data.gouv.fr/index.php?module=UsersManager&action=userSettings",children:"R\xe9cup\xe9rer mon API Authentication Token"}),Object(i.jsx)("input",{onChange:d,type:"password",value:u}),Object(i.jsx)("button",{onClick:p,children:"Supprimer le token"})]})]})}},"3Ztg":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/lecteur/cnaf/instruction",function(){return n("VtO9")}])},VtO9:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var i=n("nKUr"),a=n("KQm4"),c=n("q1tI"),r=(n("g4pe"),n("2zrp")),s=n("CafY"),o=n("RPyZ"),l=n("aIN1"),u=n("vRNQ"),h=n.n(u),j=n("GYdj"),d=n("PQ1l"),p=n("YzSY"),b=n("Svyj"),m=n("jwbB"),O=Object(d.b)("Test - CNAF - Instruction"),x=!1;function f(){var e=Object(c.useReducer)(O,[],d.a),t=e[0],n=e[1],u=Object(c.useState)(!1),f=u[0],w=u[1],g=Object(c.useState)(0),N=g[0],E=g[1],S=Object(c.useCallback)((function(e){n({type:"reset",items:e})})),v=function(e){E(e.size),w(!0);var t=new Date,i=new FileReader;i.onload=function(i){var a=new p.a(i.target.result);w(!1),n({type:"append",item:{seed:Math.random(),timestamp:(new Date).toISOString().slice(0,19),duration:new Date-t,filename:e.name,fileSize:e.size,fileDatetime:a.fileDatetime,frequency:a.frequency,origin:a.origin,parseError:a.parseError,total:a.applicationsCount,email:{total:a.withEmail.length,withAutorisation:a.withUsableEmail.length,withExplicitRefusal:a.withForbiddenEmailUsage.length,withoutAutorisationDetails:a.withoutEmailUsage.length},phone:{total:a.withPhone.length,withAutorisation:a.withUsableEmail.length,withExplicitRefusal:a.withForbiddenEmailUsage.length,withoutAutorisationDetails:a.withoutEmailUsage.length},withDSP:a.withDSP.length,applicantsPersonalData:a.applicantsPersonalData}})},i.readAsText(e)},A=function(e){return Math.round(e)};return Object(i.jsxs)(s.a,{className:h.a.container,handleFile:v,children:[Object(i.jsx)(r.a,{category:"Instruction",onRunRefresh:S}),Object(i.jsxs)("main",{className:h.a.main,children:[Object(i.jsxs)("h1",{className:h.a.title,children:["Lecteur de fichier",Object(i.jsx)("br",{}),"\xab Instruction \xbb de la CNAF"]}),Object(i.jsx)(o.a,{handleFile:v,isPending:f,fileSize:N}),t&&t.length>0&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{className:h.a.subtitle,children:"Historique"}),Object(i.jsxs)("table",{children:[Object(i.jsxs)("thead",{children:[Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{rowSpan:"2",children:"Date"}),Object(i.jsx)("th",{rowSpan:"2",children:"Fichier"}),x,x,Object(i.jsx)("th",{rowSpan:"2",children:"Date du fichier"}),Object(i.jsx)("th",{rowSpan:"2",children:"Fr\xe9quence"}),Object(i.jsx)("th",{rowSpan:"2",children:"Nature"}),Object(i.jsx)("th",{rowSpan:"2",children:"Dossiers"}),Object(i.jsx)("th",{colSpan:"8",children:"avec email"}),Object(i.jsx)("th",{colSpan:"8",children:"avec t\xe9l\xe9phone"}),Object(i.jsx)("th",{colSpan:"2",rowSpan:"2",children:"DSP (%)"}),Object(i.jsx)("th",{rowSpan:"2",children:"Erreur"})]}),Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{colSpan:"2",children:"# (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"et autorisation (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"refus explicit (%)"}),Object(i.jsx)("th",{colSpan:"2",children:Object(i.jsx)("abbr",{title:"Balise AUTORUTIADRELEC pr\xe9sente et \xe9gale \xe0 'I'",children:"inconnu explicit (I) (%)"})}),Object(i.jsx)("th",{colSpan:"2",children:"# (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"et autorisation (%)"}),Object(i.jsx)("th",{colSpan:"2",children:"refus explicit (%)"}),Object(i.jsx)("th",{colSpan:"2",children:Object(i.jsx)("abbr",{title:"Balise AUTORUTITEL pr\xe9sente et \xe9gale \xe0 'I'",children:"inconnu explicit (I) (%)"})})]})]}),Object(i.jsx)("tbody",{children:t.map((function(e){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:e.timestamp}),Object(i.jsx)("td",{children:e.filename}),x,x,Object(i.jsx)("td",{children:e.fileDatetime}),Object(i.jsx)("td",{children:"".concat(e.frequency," (").concat(j.b[e.frequency]||"?",")")}),Object(i.jsx)("td",{children:"".concat(e.origin," (").concat(j.c[e.origin]||"?",")")}),Object(i.jsx)("td",{className:h.a.numeric,children:e.total}),Object(i.jsx)("td",{className:h.a.numeric,children:e.email.total}),Object(i.jsx)("td",{className:"shrink",children:A(e.email.total/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.email.withAutorisation}),Object(i.jsx)("td",{className:"shrink",children:A(e.email.withAutorisation/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.email.withExplicitRefusal}),Object(i.jsx)("td",{className:"shrink",children:A(e.email.withExplicitRefusal/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.email.withoutAutorisationDetails}),Object(i.jsx)("td",{className:"shrink",children:A(e.email.withoutAutorisationDetails/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.phone.total}),Object(i.jsx)("td",{className:"shrink",children:A(e.phone.total/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.phone.withAutorisation}),Object(i.jsx)("td",{className:"shrink",children:A(e.phone.withAutorisation/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.phone.withExplicitRefusal}),Object(i.jsx)("td",{className:"shrink",children:A(e.phone.withExplicitRefusal/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.phone.withoutAutorisationDetails}),Object(i.jsx)("td",{className:"shrink",children:A(e.phone.withoutAutorisationDetails/e.total*100)}),Object(i.jsx)("td",{className:h.a.numeric,children:e.withDSP}),Object(i.jsx)("td",{className:"shrink",children:A(e.withDSP/e.total*100)}),Object(i.jsx)("td",{children:e.parseError?"Oui":"Non"})]},"".concat(e.timestamp,"-").concat(e.filename,"-").concat(e.seed))}))})]}),Object(i.jsx)("button",{className:h.a.button,onClick:function(){return n({type:"reset"})},children:"Vider l'historique"}),Object(i.jsx)("button",{className:h.a.button,onClick:function(){var e=[];t.forEach((function(t){t.applicantsPersonalData.forEach((function(n){e.push([].concat(Object(a.a)(Object.values(n)),[t.filename]))}))}));var n="flux_insertion_donnees_personnelles_"+Object(m.a)()+".csv";Object(b.a)(n,e,["NUMERO DEMANDE RSA","NIR","NOM","PRENOM","ROLE","EMAIL","TELEPHONE","FICHIER SOURCE"])},children:"Exporter les donn\xe9es de contacts"})]}),Object(i.jsx)(l.a,{subject:"Flux instruction CNAF",pourquoi:"Pourquoi un lecteur de fichier CNAF\xa0?",text:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("p",{className:h.a.text,children:"Tous les d\xe9partements n'ont pas les outils pour analyser les fichiers envoy\xe9s par la CNAF. Cela peut ralentir et compliquer nos \xe9changes."}),Object(i.jsx)("p",{className:h.a.text,children:"Avec cet outil, nous souhaitons permettre aux personnes qui ont acc\xe8s \xe0 ces fichiers d'en extraire des statistiques g\xe9n\xe9rales sans avoir \xe0 mettre les mains dans le camboui elles-m\xeame."}),Object(i.jsx)("p",{className:h.a.text,children:"Aujourd'hui, nous cherchons \xe0 comprendre pourquoi pour la CNAF 90% des dossiers pr\xe9sents dans les fichiers quotidiens d'instructions contiennent des emails alors que ce taux est de 30% \xe0 50% pour certains d\xe9partements."})]})})]})]})}},aIN1:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("nKUr"),a=n("oRLf"),c=n("vRNQ"),r=n.n(c);function s(e){var t=e.pourquoi,n=e.text,c=e.subject;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{id:"pourquoi",className:r.a.subtitle,children:t}),n,Object(i.jsxs)("p",{className:r.a.description,children:["Un probl\xe8me, une question ? Contactez-nous \xe0"," ",Object(i.jsx)(a.a,{subject:c,children:"data.insertion@beta.gouv.fr"})]})]})}}},[["3Ztg",0,2,1,3,4]]]);