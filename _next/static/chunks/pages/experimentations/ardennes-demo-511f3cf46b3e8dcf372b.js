_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[14],{"9Dz5":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var r=n("nKUr"),a=n("o0o1"),c=n.n(a),i=n("KQm4"),s=n("rePB"),o=n("HaE+"),l=n("q1tI"),u=n("EUZL"),d=n("CafY"),j=n("RPyZ"),p=n("aIN1"),b=n("GHpc"),O=n("vRNQ"),h=n.n(O),f=n("i0Yj"),m=n("PQ1l"),x=n("jwbB");function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=Object(m.b)("Exp\xe9rimentation Ardennes - CNAF - B\xe9n\xe9ficiaire"),_="https://demo.rdv-solidarites.fr",g=_+"/api/v1/users";function y(){var e=Object(l.useState)(null),t=e[0],n=(e[1],Object(l.useReducer)(v,[],m.a)),a=(n[0],n[1]),s=Object(l.useState)(null),O=s[0],D=s[1],y=Object(l.useState)(!1),S=y[0],E=y[1],N=Object(l.useState)(0),P=N[0],R=N[1],I=Object(l.useState)(!1),k=I[0],A=I[1],F=Object(l.useState)({tokenId:"",uid:"",client:""}),V=F[0],z=F[1];Object(l.useEffect)((function(){t&&C(t)}),[t]),Object(l.useEffect)((function(){O&&!1===S&&(O.forEach((function(e,t){""!=e["ID RDV"]&&L(e["ID RDV"],t)})),E(!0))}),[O]);function T(e,t){return B.apply(this,arguments)}function B(){return(B=Object(o.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g+"/".concat(t),e.next=3,Object(f.a)(r,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t){return M.apply(this,arguments)}function M(){return(M=Object(o.a)(c.a.mark((function e(t,n){var r,a,s,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t,V);case 2:r=e.sent,a=Object(i.a)(O),r.user.invitation_created_at&&(s=r.user.invitation_created_at.substring(0,10),s=new Date(s),a[n]["Date d'invitation"]=Object(x.c)(s)),r.user.invitation_accepted_at&&(o=r.user.invitation_accepted_at.substring(0,10),o=new Date(o),a[n]["Date d'inscription"]=Object(x.c)(o)),D(a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=function(){var e=Object(o.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(t.size),n=new Date,e.next=5,new Promise((function(e){var r=new FileReader;r.onload=function(r){var c=new Uint8Array(r.target.result),s=u.read(c,{type:"array",cellDates:!0,dateNF:"dd/mm/yyyy"}),o=s.Sheets[s.SheetNames[0]],l=u.utils.decode_range(o["!ref"]);l.s.c=0,l.e.c=24;var d=u.utils.encode_range(l),j=u.utils.sheet_to_json(o,{blankrows:!1,raw:!1,defval:"",range:d});null==(j=j.map((function(e){return Object(i.a)(Object.keys(e)).reduce((function(t,n){return t[n.replace(/[\n\r]+/g," ")]=e[n],t}),{})})))&&setIsPending(!1),E(!1),D(j),a({type:"append",item:{timestamp:(new Date).toISOString().slice(0,19),duration:new Date-n,filename:t.name,fileSize:t.size,fileLines:j.length}}),e()},r.readAsArrayBuffer(t)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(d.a,{className:h.a.container,handleFile:C,children:Object(r.jsxs)("main",{className:h.a.main,children:[Object(r.jsx)("h1",{className:h.a.title,children:"Exp\xe9rimentation Ardennes"}),!k&&Object(r.jsx)("div",{className:h.a.create,children:Object(r.jsx)(b.a,{handleLogin:function(e,t,n){z(w(w({},V),{},{tokenId:e,uid:t,client:n})),A(!0)},rdvUrl:_})}),k&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(j.a,{handleFile:C,fileSize:P,pendingMessage:"R\xe9cup\xe9ration des informations, merci de patienter"}),O&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{className:h.a.subtitle,children:"B\xe9n\xe9ficiaires RSA"}),0==O.length&&Object(r.jsx)("p",{className:h.a.description,children:"Aucun b\xe9n\xe9ficiaire dans le fichier"}),O.length>0&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("table",{children:[Object(r.jsxs)("thead",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{rowSpan:"2",children:"Date"}),Object(r.jsx)("th",{rowSpan:"2",children:"Nom"}),Object(r.jsx)("th",{rowSpan:"2",children:"Pr\xe9nom"}),Object(r.jsx)("th",{rowSpan:"2",children:"Mail"}),Object(r.jsx)("th",{rowSpan:"2",children:"T\xe9l\xe9phone"}),Object(r.jsx)("th",{rowSpan:"2",children:"ID RDV-Solidarit\xe9s"}),Object(r.jsx)("th",{colSpan:"3",children:"Invitation"})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{colSpan:"1",children:"Dernier envoi le"}),Object(r.jsx)("th",{colSpan:"1",children:"Date d'inscription"}),Object(r.jsx)("th",{colSpan:"1",children:"Action"})]})]}),Object(r.jsx)("tbody",{children:Object(i.a)(O).reverse().map((function(e,t){""!==e.DATE&&(h.a.center,e.DATE,h.a.center,e.NOM,h.a.center,e.PRENOM,h.a.center,e.MAIL,h.a.center,e.TELEPHONE,""===e["ID RDV"]&&h.a.center,""!==e["ID RDV"]&&(h.a.center,e["ID RDV"]),h.a.center,e["Date d'invitation"],h.a.center,e["Date d'inscription"],""!==e["ID RDV"]&&(h.a.center,e["Date d'invitation"],e["Date d'invitation"]),""===e["ID RDV"]&&h.a.center)}))})]}),Object(r.jsx)("button",{className:h.a.button,onClick:function(){var e=u.utils.book_new(),t=u.utils.json_to_sheet(O);u.utils.book_append_sheet(e,t,"DIVERGENCES"),u.writeFile(e,"ardennes_rsa_".concat(Object(x.b)(new Date),".xlsx"))},children:"Reg\xe9n\xe9rer fichier"})]})]})]}),Object(r.jsx)(p.a,{subject:"Exp\xe9rimentation Ardennes",pourquoi:"Quel est l'objectif de cette exp\xe9rimentation\xa0?",text:Object(r.jsx)(r.Fragment,{children:Object(r.jsx)("p",{className:h.a.text,children:"Faciliter le travail des agents du d\xe9partement et tester l'utilisation de l'application RDV-Solidarit\xe9s pour acc\xe9l\xe9rer la prise du premier rendez-vous d'orientation."})})})]})})}},lODh:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/experimentations/ardennes-demo",function(){return n("9Dz5")}])}},[["lODh",0,2,8,7,6,1,3,4,5]]]);