_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[14],{FB2r:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/identification-beneficiaires",function(){return n("gPHx")}])},gFYM:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("RHh3"),r=n("KQm4"),a=n("1OyB"),s=n("vuIU"),c=n("Ji7U"),o=n("md7G"),l=n("foSv"),u=n("sLyh"),d=n("GYdj");function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var f=function(e){Object(c.a)(n,e);var t=p(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"retrievePartitions",value:function(){return this.updatePartitions(n.initialPartitions)}},{key:"updatePartitions",value:function(e){var t=this;return this.applications.reduce((function(e,n){e.applicationsCount+=1,t.updatePartition(e.applicationDatesPartition,n.getElementsByTagName("DTDEMRSA"),!1),t.updatePartition(e.droitsPartition,n.getElementsByTagName("ETATDOSRSA")),t.updatePartition(e.devoirsPartition,n.getElementsByTagName("TOPPERSDRODEVORSA"));var a=Object(i.a)(Array,Object(r.a)(n.getElementsByTagName("Personne")));return e.applicantsCount+=a.length,a.forEach((function(i){var r;t.updatePartition(e.applicantsRolesPartition,i.getElementsByTagName("ROLEPERS")),"2"==(null===(r=n.getElementsByTagName("ETATDOSRSA")[0])||void 0===r?void 0:r.innerHTML)&&t.updatePartition(e.droitsEtDevoirsPartition,i.getElementsByTagName("TOPPERSDRODEVORSA"))})),e}),e)}},{key:"updatePartition",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t[0])return e[t[0].innerHTML]=(e[t[0].innerHTML]||0)+1,n&&(e.Total=(e.Total||0)+1),e}},{key:"applicationsCount",get:function(){return this.dom.getElementsByTagName("InfosFoyerRSA").length}},{key:"applications",get:function(){return Object(i.a)(Array,Object(r.a)(this.dom.getElementsByTagName("InfosFoyerRSA")))}},{key:"newApplicants",get:function(){return this.applicants.filter((function(e){var t;return"1"==(null===(t=e.getElementsByTagName("TOPPERSENTDRODEVORSA")[0])||void 0===t?void 0:t.innerHTML)}))}},{key:"newApplicantsPersonalData",get:function(){return this.newApplicants.map((function(e){var t,n,i,r,a,s=null===(t=e.getElementsByTagName("NOM")[0])||void 0===t?void 0:t.innerHTML,c=null===(n=e.getElementsByTagName("PRENOM")[0])||void 0===n?void 0:n.innerHTML,o=d.a[null===(i=e.getElementsByTagName("ROLEPERS")[0])||void 0===i?void 0:i.innerHTML];return{rsaApplicationNumber:null===(r=e.parentNode.getElementsByTagName("NUMDEMRSA")[0])||void 0===r?void 0:r.innerHTML,socialSecurityNumber:null===(a=e.parentNode.getElementsByTagName("NIR")[0])||void 0===a?void 0:a.innerHTML,lastName:s,firstName:c,role:o}}))}}],[{key:"initialPartitions",get:function(){return{applicationDatesPartition:{},droitsPartition:{},devoirsPartition:{},droitsEtDevoirsPartition:{},applicantsRolesPartition:{},applicantsCount:0,applicationsCount:0}}}]),n}(u.a)},gPHx:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var i=n("nKUr"),r=n("Ff2n"),a=n("KQm4"),s=n("rePB"),c=n("CafY"),o=n("RPyZ"),l=n("vRNQ"),u=n.n(l),d=n("GYdj"),p=n("q1tI"),f=n("PQ1l"),j=n("gFYM"),b=n("YzSY"),O=n("Svyj"),m=n("jwbB");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=Object(f.b)("Test - CNAF - Identification nouveaux demandeurs");function v(){var e=Object(p.useState)(0),t=e[0],n=e[1],s=Object(p.useState)(!1),l=s[0],h=s[1],v=Object(p.useReducer)(g,[],f.a),P=v[0],x=v[1],E=Object(p.useState)("b\xe9n\xe9ficiaires"),y=E[0],R=E[1],T=function(e){"b\xe9n\xe9ficiaires"==y?D(e):S(e)},A=function(){h(!1),alert("Vous n'avez pas upload\xe9 un flux ".concat(y," !"))},D=function(e){h(!0),n(e.size);var t=new FileReader;t.onload=function(t){var n=new j.a(t.target.result);if("B\xe9n\xe9ficiaires"!==d.c[n.origin])return A();h(!1),x({type:"append",item:{applicantsPersonalData:n.newApplicantsPersonalData,fileName:e.name}})},t.readAsText(e)},S=function(e){h(!0),n(e.size);var t=new FileReader;t.onload=function(e){var t=new b.a(e.target.result);if("Instructions"!==d.c[t.origin])return A();h(!1),x({type:"replace",items:M(t.applicantsPersonalData)})},t.readAsText(e)},M=function(e){return P.map((function(t){return N(N({},t),{},{applicantsPersonalData:w(e,t.applicantsPersonalData)})}))},w=function(e,t){return t.map((function(t){return N(N({},e.find((function(e){return e.rsaApplicationNumber===t.rsaApplicationNumber}))),t)}))},B=P.some((function(e){return e.applicantsPersonalData.some((function(e){return e.mailAddress}))})),F=P.some((function(e){return e.applicantsPersonalData.some((function(e){return e.phoneNumber}))}));return Object(i.jsx)(c.a,{className:u.a.container,handleFile:T,children:Object(i.jsxs)("main",{className:u.a.main,children:[Object(i.jsx)("h1",{children:"Identifiez les nouveaux demandeurs \xe0 l'aide des flux CNAF"}),Object(i.jsxs)("ol",{children:[Object(i.jsxs)("li",{style:"b\xe9n\xe9ficiaires"===y?{fontWeight:"bold"}:{},children:['Uploadez le ou les fichiers "b\xe9n\xe9ficiaires" pour identifier les nouveaux demandeurs'," ","(< 100 Mo) "]}),Object(i.jsx)("br",{}),Object(i.jsxs)("li",{children:[" ",'Une fois les flux b\xe9n\xe9ficiaires upload\xe9s, cliquez sur "Passer aux flux d\'instructions"']}),Object(i.jsx)("br",{}),Object(i.jsx)("li",{style:"instructions"===y?{fontWeight:"bold"}:{},children:'Uploadez le ou les fichiers "instructions" associ\xe9s pour r\xe9cup\xe9rer les donn\xe9es de contact des demandeurs.'})]}),Object(i.jsx)(o.a,{handleFile:T,isPending:l,fileSize:t,uploadMessage:["Glissez et d\xe9posez les flux ",Object(i.jsx)("strong",{children:y})," \xe0 analyser ou s\xe9lectionnez-les."],pendingMessage:"Traitement en cours, merci de patienter."}),P&&P.length>0&&Object(i.jsxs)(i.Fragment,{children:["b\xe9n\xe9ficiaires"===y&&Object(i.jsx)("button",{className:u.a.button,onClick:function(){return R("instructions")},children:"Passer aux flux instructions"}),"instructions"===y&&Object(i.jsx)("button",{className:u.a.button,onClick:function(){return R("b\xe9n\xe9ficiaires")},children:"Revenir aux flux b\xe9n\xe9ficiaires"}),Object(i.jsxs)("div",{className:u.a.button_group,children:[Object(i.jsx)("div",{style:{marginRight:"20px"},children:Object(i.jsxs)("button",{className:u.a.button,onClick:function(){var e=[],t=B||F;P.forEach((function(n){n.applicantsPersonalData.forEach((function(i){var r,s;t&&(null!==(r=i.mailAddress)&&void 0!==r||(i.mailAddress=""),null!==(s=i.phoneNumber)&&void 0!==s||(i.phoneNumber=""));e.push([].concat(Object(a.a)(Object.values(i)),[n.fileName]))}))}));var n=t?["NUMERO DEMANDE RSA","NIR","NOM","PRENOM","ROLE","EMAIL","TELEPHONE","FICHIER SOURCE"]:["NUMERO DEMANDE RSA","NIR","NOM","PRENOM","ROLE","FICHIER SOURCE"],i="nouveaux_demandeurs_rsa_"+Object(m.a)()+".csv";Object(O.a)(i,e,n)},children:[" ","Exporter au format CSV"," "]})}),Object(i.jsx)("div",{children:Object(i.jsx)("button",{className:u.a.button,onClick:function(){x({type:"reset"}),R("b\xe9n\xe9ficiaires")},children:"Vider l'historique"})})]}),Object(i.jsxs)("table",{className:u.a.margin_side,children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Num\xe9ro de demande RSA"}),Object(i.jsx)("th",{children:"NIR"}),Object(i.jsx)("th",{children:"Nom"}),Object(i.jsx)("th",{children:"Pr\xe9nom"}),Object(i.jsx)("th",{children:"R\xf4le"}),B&&Object(i.jsx)("th",{children:"Email"}),F&&Object(i.jsx)("th",{children:"T\xe9l\xe9phone"}),Object(i.jsx)("th",{children:"Ficher source "})]})}),Object(i.jsx)("tbody",{children:P.flatMap((function(e){var t=e.applicantsPersonalData,n=Object(r.a)(e,["applicantsPersonalData"]);return t.map((function(e){return N(N({},e),n)}))})).map((function(e){var t=e.fileName,n=Object(r.a)(e,["fileName"]),a=[n.rsaApplicationNumber,n.lastName,n.firstName,n.role,t].join("-");return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:n.rsaApplicationNumber}),Object(i.jsx)("td",{children:n.socialSecurityNumber}),Object(i.jsx)("td",{children:n.lastName}),Object(i.jsx)("td",{children:n.firstName}),Object(i.jsx)("td",{children:n.role}),B&&Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("td",{children:n.mailAddress||""})}),F&&Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("td",{children:n.phoneNumber||""})}),Object(i.jsx)("td",{children:t})]},a)}))})]})]})]})})}}},[["FB2r",0,2,1,3,4]]]);