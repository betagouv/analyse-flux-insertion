_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{CwUp:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s}));var i=n("KQm4"),r=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.reduce((function(t,i){return void 0!==i[e]&&(t[i[e]]=(t[i[e]]||0)+1,n&&(t.Total=(t.Total||0)+1)),t}),{})},a=function(t,e){return t.reduce((function(t,e){return t=t.concat(Object.keys(e)),Array.from(new Set(t))}),[])},s=function(t,e){return Object(i.a)(new Set([].concat(Object(i.a)(Object.keys(t)),Object(i.a)(Object.keys(e))))).reduce((function(n,i){return n[i]=(t[i]||0)+(e[i]||0),n}),{})}},GYdj:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var i={M:"Mensuel",I:"Quotidien",R:"Reprise"},r={D:"B\xe9n\xe9ficiaires",I:"Instructions",R:"Nouveau recueil"},a={DEM:"Demandeur",CJT:"Conjoint",ENF:"Enfant",AUT:"Autre"},s={2:"Droits ouverts et versables (2)",4:"Droits ouverts mais versements suspendus (4)"}},Ji7U:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("s4An");function r(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(i.a)(t,e)}},Svyj:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i="data:text/csv;charset=utf-8,"+n.join(";")+"\n"+e.map((function(t){return t.join(";")})).join("\n"),r=encodeURI(i),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download",t),document.body.appendChild(a),a.click()}},Uqdh:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return R}));var i=n("nKUr"),r=n("rePB"),a=n("KQm4"),s=n("o0o1"),o=n.n(s),c=n("HaE+"),u=n("CafY"),l=n("RPyZ"),p=n("UwHH"),f=n.n(p);function d(){return Object(i.jsxs)("div",{className:f.a.rules_container,children:[Object(i.jsx)("p",{children:"L'identification des nouveaux entrants est souvent difficile \xe0 mettre \xe0 place par les d\xe9partements. Cet outil vous permet d'obtenir des listes de nouveaux entrants que vous pourrez comparer avec les listes obtenues dans votre d\xe9partement."}),Object(i.jsx)("p",{children:"Pour les identifier dans les flux mensuels, nous identifions d'abord tous les b\xe9n\xe9ficiaires du RSA du mois pr\xe9c\xe9dent \xe0 l'aide du flux mensuel du mois pr\xe9c\xe9dent. Ensuite nous identifions les b\xe9n\xe9ficaires du mois qui nous int\xe9resse, et nous ne gardons que ceux qui n'ont pas \xe9t\xe9 identifi\xe9s comme b\xe9n\xe9ficiaires au mois pr\xe9c\xe9dent."}),Object(i.jsx)("p",{children:"Pour le moment, nous consid\xe9rons qu'un demandeur b\xe9n\xe9ficie du RSA si:"}),Object(i.jsxs)("ul",{children:[Object(i.jsx)("li",{children:Object(i.jsxs)("p",{children:[Object(i.jsx)("strong",{children:"ETATDOSRSA = 2"})," OU (",Object(i.jsx)("strong",{children:"ETATDOSRSA = 4 "}),"&"," ",Object(i.jsx)("strong",{children:"MOTISUSVERSRSA compris dans les valeurs : \u201801\u2019, \u201805\u2019; \u201806\u2019, \u201835\u2019, \u201836\u2019, ou \u2018CV\u2019"}),")"]})}),Object(i.jsx)("li",{children:Object(i.jsx)("p",{children:Object(i.jsx)("strong",{children:"TOPPERSDRODEVORSA = 1"})})})]})]})}var h=n("vRNQ"),b=n.n(h),j=n("q1tI"),O=n("PQ1l"),m=n("opCb"),v=n("e6fs"),y=n("GYdj"),g=n("jwbB"),x=n("Svyj");function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E=Object(O.b)("Identification nouveaux entrants quotidiens");function R(){var t=Object(j.useState)(0),e=t[0],n=t[1],r=Object(j.useState)(!1),s=r[0],p=r[1],f=Object(j.useState)("previousMonth"),h=f[0],w=f[1],R=Object(j.useState)(0),S=R[0],P=R[1],k=Object(j.useState)(0),N=k[0],_=k[1],A=Object(j.useState)(null),U=A[0],C=A[1],I=Object(j.useState)(0),M=I[0],T=I[1],W=Object(j.useReducer)(E,[],O.a),z=W[0],F=W[1],V=524288,q=function(){var t=Object(c.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=h,t.next="previousMonth"===t.t0?3:"currentMonth"===t.t0?6:"instruction"===t.t0?9:12;break;case 3:return t.next=5,H(e);case 5:return t.abrupt("return",t.sent);case 6:return t.next=8,J(e);case 8:return t.abrupt("return",t.sent);case 9:return t.next=11,L(e);case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),B=function(){var t=Object(c.a)(o.a.mark((function t(e,n,i,r){var s,c,u,l=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=l.length>4&&void 0!==l[4]?l[4]:[],c=0,u=r;case 3:if(!(c<e.size)){t.next=8;break}return t.next=6,new Promise((function(t){var r=new FileReader;r.onload=function(r){var o=new Uint8Array(r.target.result);if(c>e.size)t();else{var l=(new TextDecoder).decode(o);if(0===c){var p=l.match(/<IdentificationFlux>[\s\S]*?<\/IdentificationFlux>/),f=p&&p[0],d=new m.a(f),b=y.d[d.origin],j=y.c[d.frequency];return"B\xe9n\xe9ficiaires"!==b||"Mensuel"!==j?void alert("Vous n'avez pas upload\xe9 un flux b\xe9n\xe9ficiaires mensuel \ud83d\uded1!"):"currentMonth"===h&&Object(g.b)(d.creationDate)<=Object(g.b)(U)?void alert("Vous n'avez pas upload\xe9 un flux b\xe9n\xe9ficiaires post\xe9rieur au premier flux upload\xe9 \ud83d\uded1!"):(C(d.creationDate),c+=f.length+p.index,F({type:"append",item:{fileName:e.name,seed:n,fileSize:e.size,fileDatetime:d.fileDatetime,fileDate:U,frequency:j,origin:b}}),void t())}var O=Object(a.a)(l.matchAll(/<InfosFoyerRSA>[\s\S]*?<\/InfosFoyerRSA>/g)),v=O.map((function(t){return t[0]})).join("");if(0===v.length)return c+=V,void t();var x=O[O.length-1];c+=x.index+x[0].length;var w=new m.a("<Racine>"+v+"</Racine>");u=i(w,u,s),P((function(t){return t+w.applicationsCount})),t()}};var o=e.slice(c,c+V);r.readAsArrayBuffer(o)}));case 6:t.next=3;break;case 8:return t.abrupt("return",u);case 9:case"end":return t.stop()}}),t)})));return function(e,n,i,r){return t.apply(this,arguments)}}(),H=function(){var t=Object(c.a)(o.a.mark((function t(e){var i,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(e.size),0,i="previousMonth",new Date,t.next=6,B(e,i,(function(t,e,n){return e.concat(t.applicantsWithRights.map((function(t){return t.id})))}),[]);case 6:r=t.sent,F({type:"update",item:{seed:i,applicantsWithRightsIds:r}}),P(0),w("currentMonth"),alert("Les b\xe9n\xe9ficiaires du mois pr\xe9c\xe9dent ont \xe9t\xe9 identifi\xe9s \u2705.\nVeuillez maintenant uploader le flux du mois \xe0 traiter.");case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=function(){var t=Object(c.a)(o.a.mark((function t(e){var i,r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(e.size),0,i="currentMonth",new Date,r=z.find((function(t){return"previousMonth"===t.seed})).applicantsWithRightsIds,t.next=7,B(e,i,(function(t,e,n){return t.applicantsWithRights.forEach((function(t){n.includes(t.id)||e.push(D(D({},t.personalData()),{},{applicationStatusCode:t.applicationStatusCode}))})),e}),[],r);case 7:a=t.sent,F({type:"update",item:{seed:i,applicantsWithRights:a}}),P(0),_(a.length),w("instruction"),alert("".concat(a.length," nouveaux b\xe9n\xe9ficaires ont \xe9t\xe9s identifi\xe9s  \u2705!\n")+"Ajouter des flux instructions pour retrouver des donn\xe9es de contacts et exporter le tout.");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=Object(c.a)(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(e.size),t.next=3,new Promise((function(t){var n=new FileReader;n.onload=function(n){var i=new v.a(n.target.result);if("Instructions"!==y.d[i.origin])return alert("Vous n'avez pas upload\xe9 un flux instruction \ud83d\uded1!"),void t();var r=z.find((function(t){return"currentMonth"===t.seed})).applicantsWithRights;F({type:"update",item:{seed:"currentMonth",applicantsWithRights:Q(i.applicants,e.name,r)}}),t()},n.readAsText(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Q=function(t,e,n){return n.map((function(n){var i=t.find((function(t){return t.rsaApplicationNumber===n.rsaApplicationNumber}));return i?(T((function(t){return t+1})),D(D({instructionFileName:e},n),i.contactInfos())):n}))};return Object(i.jsx)(u.a,{className:b.a.container,handleFile:q,children:Object(i.jsxs)("main",{className:b.a.main,children:[Object(i.jsx)("h1",{children:"Identifiez les nouveaux demandeurs \xe0 l'aide des flux CNAF"}),Object(i.jsxs)("ol",{children:[Object(i.jsxs)("li",{style:"previousMonth"===h?{fontWeight:"bold"}:{},children:["Uploadez le flux mensuel du mois pr\xe9c\xe9dant le fichier que vous voulez analyser (",Object(i.jsx)("strong",{children:"M - 1"}),")"]}),Object(i.jsx)("br",{}),Object(i.jsxs)("li",{style:"currentMonth"===h?{fontWeight:"bold"}:{},children:["Uploadez le flux mensuel que vous voulez analyser (",Object(i.jsx)("strong",{children:"M"}),")"]}),Object(i.jsx)("br",{}),Object(i.jsx)("li",{style:"instruction"===h?{fontWeight:"bold"}:{},children:'Uploadez le ou les fichiers "instructions" associ\xe9s pour r\xe9cup\xe9rer les donn\xe9es de contact des b\xe9n\xe9ficaires.'})]}),!s&&Object(i.jsx)("button",{className:b.a.button,onClick:function(){return p(!0)},children:"Voir les r\xe8gles d'identifications"}),s&&Object(i.jsx)("button",{className:b.a.button,onClick:function(){return p(!1)},children:"Cacher les r\xe8gles d'identifications"}),s&&Object(i.jsx)(d,{}),Object(i.jsx)(l.a,{handleFile:q,fileSize:e,multiple:"instruction"===h,uploadMessage:"Glissez et d\xe9posez le flux \xe0 analyser ou s\xe9lectionnez-le.",pendingMessage:"instruction"===h?"Matching en cours...":"".concat(S," demandes trait\xe9es")}),"instruction"===h&&Object(i.jsxs)("div",{className:b.a.button_group,children:[Object(i.jsx)("div",{style:{marginRight:"20px"},children:Object(i.jsxs)("button",{className:b.a.button,onClick:function(){var t=z.find((function(t){return"currentMonth"===t.seed})),e=t.applicantsWithRights.map((function(e){return[e.rsaApplicationNumber||"",y.b[e.applicationStatusCode]||"",e.socialSecurityNumber||"",e.lastName||"",e.firstName||"",y.a[e.role]||"",e.emailAddress||"",e.phoneNumber||"",t.fileName,e.instructionFileName||""]})),n="nouveaux_demandeurs_rsa_mensuels_"+Object(g.d)()+".csv";Object(x.a)(n,e,["NUMERO DEMANDE RSA","STATUT DE LA DEMANDE","NIR","NOM","PRENOM","ROLE","EMAIL","TELEPHONE","FICHIER SOURCE","FICHIER D'INSTRUCTION"])},children:[" ","Exporter les ",N," nouveaux b\xe9n\xe9ficiaires au format CSV"," "]})}),Object(i.jsx)("div",{children:Object(i.jsx)("button",{className:b.a.button,onClick:function(){F({type:"reset"}),w("previousMonth")},children:"Vider l'historique"})})]}),"instruction"===h&&M>0&&Object(i.jsxs)("h3",{children:[M," b\xe9n\xe9ficiaires retrouv\xe9s dans les flux instructions"]})]})})}},UwHH:function(t,e,n){t.exports={rules_container:"NewApplicantsRules_rules_container__1_-sB",image_container:"NewApplicantsRules_image_container__3YSoU",rules_image:"NewApplicantsRules_rules_image__35bJ7"}},e6fs:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("KQm4"),r=n("1OyB"),a=n("vuIU"),s=n("Ji7U"),o=n("md7G"),c=n("foSv"),u=n("DCjv"),l=n("oIwm"),p=(n("z4L3"),n("CwUp"));function f(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Object(c.a)(t);if(e){var r=Object(c.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(t){Object(s.a)(n,t);var e=f(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(a.a)(n,[{key:"applications",get:function(){return Object(i.a)(this.dom.getElementsByTagName("InfoDemandeRSA")).map((function(t){return new l.a(t)}))}},{key:"applicationsWithEmail",get:function(){return this.applications.filter((function(t){return t.emailAddress}))}},{key:"applicationsWithUsableEmail",get:function(){return this.applications.filter((function(t){return t.withUsableEmail()}))}},{key:"applicationsWithForbiddenEmailUsage",get:function(){return this.applications.filter((function(t){return t.withForbiddenEmailUsage()}))}},{key:"applicationsWithoutEmailUsage",get:function(){return this.applications.filter((function(t){return t.withoutEmailUsage()}))}},{key:"applicatonsWithPhone",get:function(){return this.applications.filter((function(t){return t.phoneNumber}))}},{key:"applicationsWithUsablePhone",get:function(){return this.applications.filter((function(t){return t.withUsablePhone()}))}},{key:"applicationsWithForbiddenPhoneUsage",get:function(){return this.applications.filter((function(t){return t.withForbiddenPhoneUsage()}))}},{key:"applicationsWithoutPhoneUsage",get:function(){return this.applications.filter((function(t){return t.withoutPhoneUsage()}))}},{key:"applicationsWithDSP",get:function(){return this.applications.filter((function(t){return t.withDSP()}))}},{key:"applicantsWithDSP",get:function(){return this.applicants.filter((function(t){return t.socioProfessionalData}))}},{key:"applicantsPersonalData",get:function(){return this.applicants.map((function(t){return t.personalData()}))}},{key:"nationalitiesPartition",get:function(){return Object(p.a)(this.applicants,"nationality",!1)}},{key:"dspRolesPartition",get:function(){return Object(p.a)(this.applicantsWithDSP,"role")}},{key:"activitiesPartition",get:function(){return Object(p.a)(this.applicants,"activity",!1)}}]),n}(u.a)},foSv:function(t,e,n){"use strict";function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return i}))},jBUd:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/identification-beneficiaires/flux-mensuels",function(){return n("Uqdh")}])},md7G:function(t,e,n){"use strict";function i(t){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return!e||"object"!==i(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}n.d(e,"a",(function(){return r}))},opCb:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("KQm4"),r=n("1OyB"),a=n("vuIU"),s=n("Ji7U"),o=n("md7G"),c=n("foSv"),u=n("DCjv"),l=n("oIwm"),p=n("CwUp");function f(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Object(c.a)(t);if(e){var r=Object(c.a)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(t){Object(s.a)(n,t);var e=f(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(a.a)(n,[{key:"applications",get:function(){return Object(i.a)(this.dom.getElementsByTagName("InfosFoyerRSA")).map((function(t){return new l.a(t)}))}},{key:"topEntrants",get:function(){return this.applicants.filter((function(t){return t.isTopEntrant()}))}},{key:"applicantsWithDroitsOuvertsEtVersables",get:function(){return this.applicants.filter((function(t){return t.application.withDroitsOuvertsEtVersables()}))}},{key:"applicantsWithRights",get:function(){return this.applicants.filter((function(t){return t.withRights()}))}},{key:"partitions",get:function(){return{applicationsDatesPartition:this.applicationsDatesPartition,applicationsStatusCodesPartition:this.applicationsStatusCodesPartition,applicantsTopDroitsEtDevoirsPartition:this.applicantsTopDroitsEtDevoirsPartition,applicantsRolesPartition:this.applicantsRolesPartition,applicantsWithDroitsOuvertsEtVersablesTopDroitsEtDevoirsPartition:this.applicantsWithDroitsOuvertsEtVersablesTopDroitsEtDevoirsPartition}}},{key:"applicationsDatesPartition",get:function(){return Object(p.a)(this.applications,"date",!1)}},{key:"applicationsStatusCodesPartition",get:function(){return Object(p.a)(this.applications,"statusCode")}},{key:"applicantsTopDroitsEtDevoirsPartition",get:function(){return Object(p.a)(this.applicants,"topDroitsEtDevoirs")}},{key:"applicantsRolesPartition",get:function(){return Object(p.a)(this.applicants,"role")}},{key:"applicantsWithDroitsOuvertsEtVersablesTopDroitsEtDevoirsPartition",get:function(){return Object(p.a)(this.applicantsWithDroitsOuvertsEtVersables,"topDroitsEtDevoirs")}}]),n}(u.a)},s4An:function(t,e,n){"use strict";function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return i}))}},[["jBUd",0,2,1,3,4]]]);